build-ris-bussvcs-dev/eu-west-2/pdev:
  extends: .build
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/eu-west-2/pdev'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
    - export TF_VAR_mssql_admin_username=$mssql_username
    - export TF_VAR_mssql_admin_password=$mssql_password
  only:
    refs:
      - merge_requests
      - master
    changes:
      - live/ris-bussvcs-dev/eu-west-2/pdev/**/*
      - live/*.hcl
      - modules/**/*

ris-bussvcs-dev/eu-west-2/pdev:
  extends: .deploy
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/eu-west-2/pdev'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
  dependencies: [build-ris-bussvcs-dev/eu-west-2/pdev]
  environment:
    name: ris-bussvcs-dev/eu-west-2/pdev
  only:
    refs:
      - master
    changes:
      - live/ris-bussvcs-dev/eu-west-2/pdev/**/*
      - live/*.hcl
      - modules/**/*

build-ris-bussvcs-dev/eu-west-2/tdev:
  extends: .build
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/eu-west-2/tdev'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
    - export TF_VAR_mssql_admin_username=$mssql_username
    - export TF_VAR_mssql_admin_password=$mssql_password
  only:
    refs:
      - merge_requests
      - master
    changes:
      - live/ris-bussvcs-dev/eu-west-2/tdev/**/*
      - live/*.hcl
      - modules/**/*

ris-bussvcs-dev/eu-west-2/tdev:
  extends: .deploy
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/eu-west-2/tdev'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
  dependencies: [build-ris-bussvcs-dev/eu-west-2/tdev]
  environment:
    name: ris-bussvcs-dev/eu-west-2/tdev
  only:
    refs:
      - master
    changes:
      - live/ris-bussvcs-dev/eu-west-2/tdev/**/*
      - live/*.hcl
      - modules/**/*

build-ris-bussvcs-dev/us-east-1/tmxdemo:
  extends: .build
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/us-east-1/tmxdemo'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
    - export TF_VAR_mssql_admin_username=$mssql_username
    - export TF_VAR_mssql_admin_password=$mssql_password
  only:
    refs:
      - merge_requests
      - master
    changes:
      - live/ris-bussvcs-dev/us-east-1/tmxdemo/**/*
      - live/*.hcl
      - modules/**/*

ris-bussvcs-dev/us-east-1/tmxdemo:
  extends: .deploy
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/us-east-1/tmxdemo'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
  dependencies: [build-ris-bussvcs-dev/us-east-1/tmxdemo]
  environment:
    name: ris-bussvcs-dev/us-east-1/tmxdemo
  only:
    refs:
      - master
    changes:
      - live/ris-bussvcs-dev/us-east-1/tmxdemo/**/*
      - live/*.hcl
      - modules/**/*

build-ris-bussvcs-dev/us-east-2/pncsupport:
  extends: .build
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/us-east-2/pncsupport'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
    - export TF_VAR_mssql_admin_username=$mssql_username
    - export TF_VAR_mssql_admin_password=$mssql_password
  only:
    refs:
      - merge_requests
      - master
    changes:
      - live/ris-bussvcs-dev/us-east-2/pncsupport/**/*
      - live/*.hcl
      - modules/**/*

ris-bussvcs-dev/us-east-2/pncsupport:
  extends: .deploy
  variables:
    ROOT_DIR: 'live/ris-bussvcs-dev/us-east-2/pncsupport'
    AWS_PROFILE: 'ris-bussvcs-dev'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
  dependencies: [build-ris-bussvcs-dev/us-east-2/pncsupport]
  environment:
    name: ris-bussvcs-dev/us-east-2/pncsupport
  only:
    refs:
      - master
    changes:
      - live/ris-bussvcs-dev/us-east-2/pncsupport/**/*
      - live/*.hcl
      - modules/**/*

build-ris-bussvcs-prod/eu-west-2/ukdemo:
  extends: .build
  variables:
    ROOT_DIR: 'live/ris-bussvcs-prod/eu-west-2/ukdemo'
    AWS_PROFILE: 'ris-bussvcs-prod'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-prod'
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::485575125510:role/ADFS-TAS-Terraform'
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
    - export TF_VAR_mssql_admin_username=$mssql_username
    - export TF_VAR_mssql_admin_password=$mssql_password
  only:
    refs:
      - merge_requests
      - master
    changes:
      - live/ris-bussvcs-prod/eu-west-2/ukdemo/**/*
      - live/*.hcl
      - modules/**/*

ris-bussvcs-prod/eu-west-2/ukdemo:
  extends: .deploy
  variables:
    ROOT_DIR: 'live/ris-bussvcs-prod/eu-west-2/ukdemo'
    AWS_PROFILE: 'ris-bussvcs-prod'
  before_script:
    - export ADFS_PROFILE=(
        'ris-bussvcs-prod'
        'ris-bussvcs-dev'
      )
    - export ADFS_ROLE_ARN=(
        'arn:aws:iam::485575125510:role/ADFS-TAS-Terraform'
        'arn:aws:iam::152186781777:role/ADFS-TAS-Terraform'
      )
  dependencies: [build-ris-bussvcs-prod/eu-west-2/ukdemo]
  environment:
    name: ris-bussvcs-prod/eu-west-2/ukdemo
  only:
    refs:
      - master
    changes:
      - live/ris-bussvcs-prod/eu-west-2/ukdemo/**/*
      - live/*.hcl
      - modules/**/*

